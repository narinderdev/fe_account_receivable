<div class="payments-page">
  <div class="button-receive">
    <!-- <h1 class="page-title">Payments</h1> -->
    <button
      class="action-button"
      routerLink="receive-payment"
      *ngIf="canApplyPayment"
    >
      Receive Payments
    </button>
  </div>

  <!-- FULL SCREEN LOADER -->
  <div *ngIf="loading" class="loader-wrapper">
    <app-loader [visible]="loading"></app-loader>
  </div>

  <!-- TABLE CONTENT -->
  <div class="payments-card" *ngIf="!loading">
    <table class="payments-table">
      <thead>
        <tr>
          <th>Customer</th>
          <th>Status</th>
          <th>Applied Amount</th>
          <th>Payment Method</th>
          <th>Payment Date</th>
        </tr>
      </thead>

      <tbody>
        <!-- EMPTY STATE -->
        <tr *ngIf="payments.length === 0" class="no-data-row">
          <td colspan="5">No payments found.</td>
        </tr>

        <!-- PAYMENT ROWS -->
        <tr
          *ngFor="let payment of payments; let i = index"
          (click)="openPaymentDetails(payment.id)"
        >
          <td>
            <div class="customer-info">
              <div
                class="customer-initial"
                [ngStyle]="{
                  backgroundColor: getInitialColor(i).background,
                  color: getInitialColor(i).color
                }"
              >
                {{ getCustomerInitial(payment) }}
              </div>
              <span class="customer-name">{{ getCustomerName(payment) }}</span>
            </div>
          </td>

          <td>
            <span class="status-badge" [ngClass]="getStatusClass(payment)">
              {{ getInvoiceStatus(payment) }}
            </span>
          </td>
          <td>{{ getAppliedAmount(payment) | currency }}</td>
          <td>{{ payment.paymentMethod || '--' }}</td>
          <td>{{ payment.paymentDate | date : 'mediumDate' }}</td>
        </tr>
      </tbody>
    </table>
    <div class="pagination-wrapper" *ngIf="totalPages > 1 && !loading">
    <div class="pagination-info">
      Showing {{ currentPage * pageSize + 1 }} to
      {{ Math.min((currentPage + 1) * pageSize, totalItems) }} of {{ totalItems }} results
    </div>

    <div class="pagination-controls">
      <button class="page-nav-btn" (click)="prevPage()" [disabled]="currentPage === 0">
        <img src="/assets/left.svg" alt="Previous" class="pagination-icon" />
      </button>

      <button
        *ngFor="let page of getPageNumbers()"
        class="page-number-btn"
        [class.active]="page === currentPage + 1"
        [class.ellipsis]="page === -1"
        (click)="page !== -1 && goToPage(page - 1)"
        [disabled]="page === -1"
      >
        {{ page === -1 ? '...' : page }}
      </button>

      <button
        class="page-nav-btn"
        (click)="nextPage()"
        [disabled]="currentPage === totalPages - 1"
      >
        <img src="/assets/right.svg" alt="Next" class="pagination-icon" />
      </button>
    </div>
  </div>
  </div>
</div>
