<div class="dispute-details-page">
  <div class="header-row">
    <h2>Dispute Details</h2>
    <!-- Status Action Buttons in Header -->
    <div
      class="action-buttons"
      *ngIf="!loading && !error && dispute && (showUnderReviewButton || showResolvedButton || showRejectedButton)"
    >
      <button
        *ngIf="showUnderReviewButton"
        class="btn-primary"
        (click)="onUnderReviewClick()"
        [disabled]="updatingStatus"
      >
        {{ updatingStatus ? 'Updating...' : 'Under Review' }}
      </button>

      <button
        *ngIf="showResolvedButton"
        class="btn-success"
        (click)="onResolvedClick()"
        [disabled]="updatingStatus"
      >
        {{ updatingStatus ? 'Updating...' : 'Resolved' }}
      </button>

      <button
        *ngIf="showRejectedButton"
        class="btn-danger"
        (click)="onRejectedClick()"
        [disabled]="updatingStatus"
      >
        {{ updatingStatus ? 'Updating...' : 'Rejected' }}
      </button>
    </div>
  </div>

  <div *ngIf="loading" class="centered">
    <app-spinner></app-spinner>
  </div>

  <div *ngIf="!loading && error" class="error-box">
    {{ error }}
  </div>

  <ng-container *ngIf="!loading && !error && dispute">
    <div class="summary-card">
      <!-- Dispute ID inside the card -->
      <div class="dispute-id-row">
        <div class="summary-item">
          <label>Dispute ID</label>
          <div class="value">{{ dispute.disputeId || disputeId }}</div>
        </div>
      </div>

      <div class="summary-grid">
        <div class="summary-item">
          <label>Customer</label>
          <div class="value">{{ customerName }}</div>
        </div>
        <div class="divider"></div>
        <div class="summary-item">
          <label>Invoice</label>
          <div class="value">{{ invoiceNumber }}</div>
        </div>
      </div>

      <div class="summary-grid">
        <div class="summary-item">
          <label>Invoice Amount</label>
          <div class="value">{{ dispute.invoiceOriginalAmount | currency }}</div>
        </div>
        <div class="divider"></div>
        <div class="summary-item">
          <label>Disputed Amount</label>
          <div class="value highlight">{{ dispute.disputedAmount | currency }}</div>
        </div>
      </div>

      <div class="summary-grid">
        <div class="summary-item">
          <label>Status</label>
          <div class="value status">{{ disputeStatus }}</div>
        </div>
        <div class="divider"></div>
        <div class="summary-item">
          <label>Dispute Code</label>
          <div class="value">{{ dispute.disputeCode }}</div>
        </div>
      </div>

      <div class="full-row">
        <label>Reason</label>
        <p>{{ dispute.reason || '--' }}</p>
      </div>
    </div>

    <div class="card">
      <h3>Invoice Details</h3>
      <div class="details-row">
        <div>
          <label>Invoice Date</label>
          <p>{{ dispute.invoice.invoiceDate | date }}</p>
        </div>
        <div>
          <label>Due Date</label>
          <p>{{ dispute.invoice.dueDate | date }}</p>
        </div>
        <div>
          <label>Status</label>
          <p>{{ dispute.invoice.status || '--' }}</p>
        </div>
      </div>

      <div class="details-row">
        <div>
          <label>Subtotal</label>
          <p>{{ dispute.invoice.subTotal | currency }}</p>
        </div>
        <div>
          <label>Total Amount</label>
          <p>{{ dispute.invoice.totalAmount | currency }}</p>
        </div>
        <div>
          <label>Balance Due</label>
          <p>{{ dispute.invoice.balanceDue | currency }}</p>
        </div>
      </div>
    </div>
  </ng-container>
</div>